/**
 * @appular docs - displays documentation from json generated by grunt-appular-docs
 */
define([
    'jquery',
    'underscore',
    'backbone',
    './model',
    './views/nav/view',
    './views/docs/view',
    'template!./template.html'
], function ($, _, Backbone, Model, Nav, Docs, template) {
    var View = Backbone.View.extend({
            model: new Model(),
            template: template,
            listeners: {
                'model change:view': 'updateView',
                'app change:view': 'render'
            },
            events: {},
            initialize: function () {
                this.set({
                    view: this.app.get('view')
                }, {
                    silent: true
                });
            },
            render: function () {
                this.$el.html(this.template());
                
                this.views.nav = new Nav({
                    el: '#module-docs-nav',
                    model: this.model
                }).render();
                
                this.views.docs = new Docs({
                    el: '#module-docs-docs',
                    model: this.model
                }).render();

                return this;
            },
            updateView: function () {
                this.app.set('view', this.get('view'));
            }
        });

    return View;
});